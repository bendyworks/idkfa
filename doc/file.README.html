<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.7.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><p><img src="https://raw.github.com/bendyworks/idkfa/master/doc/stop.png" alt="" /></p>
<h1><span class="caps">STOP</span>!</h1>
<p>No, seriously. <span class="caps">STOP</span>!</p>
<p>This <span class="caps">README</span> is not yet accurate! That is, do not assume any of this documentation is true until this notice is removed!</p>
<h1>idkfa: Share Sensitive Information Securely</h1>
<p>Storing sensitive information (<span class="caps">API</span> keys, passwords, etc) in your repository is generally considered A Bad Idea&trade;. That leaves us with the problem of sharing this information out-of-band, which is an error-prone, arduous process. With <code>idkfa</code>, you can seamlessly store and use your credentials from within the repository using the magic of <strong>encryption</strong>.</p>
<p>There are two interfaces to <code>idkfa</code>: from the command line and as a library. From the command line, you manage the permissions and keys. Using <code>idkfa</code> as a ruby library, you can get access to the keys inside your application.</p>
<p>The name <code>idkfa</code> comes from the cheat code for Doom which, among other things, gives you all keys.</p>
<h2>Technology</h2>
<p><code>idkfa</code> uses both public key (<span class="caps">RSA</span>, asymmetric) and block (<span class="caps">AES</span>, symmetric) encryption to provide a secure, scalable way of storing sensitive information.</p>
<h2>A <span class="caps">WARNING</span></h2>
<p>This tool does not prevent tampering with your sensitive information. For example, if someone gets write-access to your repository and messes around with the credentials file, you could accidentally give them access at a later date.</p>
<p>This &#8220;hole&#8221; may be fixed in the future. Please comment on the <a href="https://github.com/bendyworks/idkfa/issues/1">appropriate issue</a> if you have ideas.</p>
<h1>Getting Started</h1>
<h2>Installation</h2>
<p>Install <code>idkfa</code> as a gem:</p>
<pre class="code"><span class='id gem'>gem</span> <span class='id install'>install</span> <span class='id idkfa'>idkfa</span></pre>
<p>or declare it in your Gemfile:</p>
<pre class="code"><span class='id gem'>gem</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>idkfa</span><span class='tstring_end'>'</span></span></pre>
<h2>Initialization</h2>
<p>Then initialize <code>idkfa</code> with:</p>
<pre class="code">$ idkfa init</pre>
<p>This will generate a public/private keypair in <code>~/.idkfa/</code> (if it doesn&#8217;t already exist). It will also create a <code>credentials.yml</code> file in <code>./config/</code> (if <code>./config/</code> exists) or in the current directory. If you&#8217;d like to specify the location, use the <code>-c</code> flag:</p>
<pre class="code">$ idkfa init -c keys/credentials.yml</pre>
<p>Sample <code>credentials.yml</code>:</p>
<pre class="code">---
keys:
- id: '&lt;your-login@your-computer&gt;'
  public_key: '&lt;your idkfa-specific rsa public key&gt;'
  symmetric_key: '&lt;the aes key, encrypted with rsa public key&gt;'
content: '&lt;aes-encrypted, base64-encoded YAML&gt;'</pre>
<p>Here&#8217;s an example of what a <code>credentials.yml</code> might look like with a couple developers and servers:</p>
<pre class="code">---
keys:
- id: 'alice@alice.example.com'
  public_key: '&lt;idkfa-specific rsa public key for alice&gt;'
  symmetric_key: '&lt;the aes key, encrypted with rsa public key for alice&gt;'
- id: 'bob@bob.example.com'
  public_key: '&lt;idkfa-specific rsa public key for bob&gt;'
  symmetric_key: '&lt;the aes key, encrypted with rsa public key for bob&gt;'
- id: staging server
  public_key: '&lt;rsa public key for staging server&gt;'
  symmetric_key: '&lt;the aes key, encrypted with rsa public key for staging server&gt;'
- id: production server
  public_key: '&lt;rsa public key for production server&gt;'
  symmetric_key: '&lt;the aes key, encrypted with rsa public key for production server&gt;'
content: '&lt;aes-encrypted, base64-encoded YAML&gt;'</pre>
<p>When the value of the <code>content</code> key is decrypted, it is a simple <span class="caps">YAML</span> file. The generated file structure is in the following form:</p>
<pre class="code">---
development:
  # twitter_consumer_key: 'insert consumer key here'
test:
  # twitter_consumer_key: 'insert consumer key here'
staging:
  # twitter_consumer_key: 'insert consumer key here'
production:
  # twitter_consumer_key: 'insert consumer key here'</pre>
<p>Changing this information is covered in <a href="#manage-sensitive-information">Managing Your Sensitive Data</a></p>
<h1>Managing Access</h1>
<h2 id="managing-user-access">User Access</h2>
<h3>Creating Your Public/Private Keypair</h3>
<p>Running <code>idkfa init</code> from the command line will automatically generate a public/private keypair for the current user. It will, however, also generate <code>credentials.yml</code> in the same directory. If you do not need to generate a credentials file, you can instead run:</p>
<pre class="code">$ idkfa keygen</pre>
<p>This will simply generate a public/private keypair if one does not already exist.</p>
<h3>Granting Access to Others</h3>
<p>Let&#8217;s say you&#8217;re the initial user of <code>idkfa</code> on a project. That is, you were the one who ran <code>idkfa init</code> to generate the credentials file. That would mean you&#8217;re the only one authorized to decrypt the sensitive information. A valid use case to be sure, but not great if you intend to collaborate.</p>
<h4>If You&#8217;ve Never Granted Access to the Other Developer</h4>
<p>Granting access to others is quite simple. Have the other developer run <code>idkfa keygen</code> from the command line. This will generate two files: <code>~/.idkfa/default.public.yml</code> and <code>~/.idkfa/.default.private.yml</code>. Transfer the <strong>public</strong> keyfile on a secure channel, like <code>scp</code> or sneaker-net. On the authorized computer, run:</p>
<pre class="code">$ idkfa import other_users_public_key.yml</pre>
<p>This will authorize the other developer and remember the public key for future authorizations in <code>~/.idkfa/others.yml</code>.</p>
<h5>On the Same Network?</h5>
<p>If you&#8217;re on the same network as the other user, you can run:</p>
<pre class="code">$ idkfa serve</pre>
<p>This will open a server on port 48484 (or you can pass <code>-p PORT</code>). The other developer can then run:</p>
<pre class="code">$ idkfa request &lt;hostname[:port]&gt;</pre>
<p>The user running the server will be prompted to verify a fingerprint (generally done out of band, like vocally). Once verified, the requestor&#8217;s credentials file will be updated to be authorized. Upon completion, the server will terminate (this can be prevented with <code>--keep-open</code>).</p>
<h4>If You&#8217;ve Previously Granted Access to the Other Developer</h4>
<p>If the user&#8217;s key already exists in <code>~/.idkfa/others.yml</code>, simply run the following:</p>
<pre class="code">$ idkfa authorize user@host</pre>
<p>If you don&#8217;t remember the other developer&#8217;s username and host, you can use the following:</p>
<pre class="code">$ idkfa authorize --list</pre>
<p>If you just want to authorize everyone in your <code>~/.idkfa/others.yml</code> file, use:</p>
<pre class="code">$ idkfa authorize --all</pre>
<h2>Computer (eg: Server) Access</h2>
<p>Granting a server access to the encrypted sensitive information is no different than granting a <a href="#managing-user-access">user access.</a> You simply use the user who is used to run the application. <code>idkfa</code>, however, provides convenience plugins to grant server access in certain circumstances.</p>
<h3>Heroku</h3>
<p>Until the <code>heroku-idkfa</code> gem is written, run the following to generate a new keypair:</p>
<pre class="code">$ idkfa keygen heroku</pre>
<p>Then, run the following to put the keypair up on heroku:</p>
<pre class="code">$ heroku config:add IDKFA_KEYS=&quot;$(idkfa base64 heroku)&quot;</pre>
<p><s>Please see the <a href="https://github.com/bendyworks/heroku-idkfa">heroku-idkfa</a> gem to use <code>idkfa</code> seamlessly with <a href="http://heroku.com">heroku</a>. </s></p>
<h3>Capistrano</h3>
<p>Until the <code>capistrano-idkfa</code> gem is written, simply log onto the server as the application&#8217;s user and follow the <a href="#managing-user-access">standard user access instructions</a>.</p>
<p><s>Please see the <a href="https://github.com/bendyworks/capistrano-idkfa">capistrano-idkfa</a> gem to use <code>idkfa</code> seamlessly with <a href="http://capify.org">capistrano</a>. </s></p>
<h3>Engine Yard</h3>
<p>Until the <code>ey-idkfa</code> gem is written, simply log onto the server as the application&#8217;s user and follow the <a href="#managing-user-access">standard user access instructions</a>.</p>
<p><s>Please see the <a href="https://github.com/bendyworks/ey-idkfa">ey-idkfa</a> gem to use <code>idkfa</code> seamlessly with <a href="http://www.engineyard.com">Engine Yard Cloud</a>. </s></p>
<h2>Revoking Access</h2>
<p>Revoking access is simple, but you must remember that the revoked user probably still has the ability to read old versions of your credentials file. In other words, once you&#8217;ve revoked the user, you&#8217;ll want to manually <a href="#manage-sensitive-information">reset all of your sensitive information</a> (assuming you can reset your <span class="caps">API</span> keys!).</p>
<p>To revoke a user:</p>
<pre class="code">$ idkfa revoke user@host</pre>
<p>This removes the revokee&#8217;s information from the credentials file and resets the symmetric key for everyone else. Do not be surprised when your source code management tool reports that your credentials file will be almost entirely rewritten.</p>
<h1 id="manage-sensitive-information">Managing Your Sensitive Information</h1>
<p>Since your sensitive information is encrypted, you cannot directly manage that data. <code>idkfa</code> provides the ability to dump your sensitive data to a file (credentials.unencrypted.yml) in the same directory as your credentials file:</p>
<pre class="code">$ idkfa dump</pre>
<p>When you&#8217;re done, be sure to load the unencrypted file back into encrypted form:</p>
<pre class="code">$ idkfa load</pre>
<p><s>If you&#8217;d rather not dump the sensitive information to disk, you can edit it in-place with:</p>
<pre class="code">$ idkfa edit</pre>
<p></s></p>
<h1>Usage in Code</h1>
<ul>
	<li>Install as a gem (see &#8220;Getting Started&#8221;)</li>
	<li>In some initialization portion of your code, you may optionally specify a default namespace: <code>Idkfa.default_namespace = 'production'</code> (in the presence of Rails, this will be done automatically)</li>
	<li>In your code, use <code>Idkfa['twitter_consumer_key']</code> (Idkfa will autoload your credentials on first use)</li>
</ul>
<h1>Developer Notes</h1>
<ul>
	<li>https://github.com/radar/guides/blob/master/gem-development.md</li>
	<li>https://github.com/blambeau/quickl (probably not necessary, but we can at least evaluate it)</li>
</ul>
<h1>Acknowledgements</h1>
<p>Written by:</p>
<ul>
	<li><a href="https://github.com/listrophy">Bradley Grzesiak</a> &#8211; <a href="http://bendyworks.com">Bendyworks</a></li>
	<li><a href="https://github.com/whazzmaster">Zachery Moneypenny</a></li>
</ul>
<p>Conceived with the help of:</p>
<ul>
	<li><a href="https://github.com/Jaym3s">Jaymes Waters</a> &#8211; <a href="http://bendyworks.com">Bendyworks</a></li>
	<li><a href="https://github.com/randland">Nick Karpenske</a> &#8211; <a href="http://bendyworks.com">Bendyworks</a></li>
</ul></div></div>
    
    <div id="footer">
  Generated on Wed Aug 24 12:02:14 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>